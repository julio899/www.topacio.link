import{cp as U,r as H,ci as R,p,i as $}from"./index-ChdcCclG.js";const G="https://api.binance.com",C=new $,q=U("chart",()=>{const m=H(!1),t=R({symbols:"BTCUSDT",temporality:"15m",exchange:"binance",pairs:[],indicators:{divergences:!1,adx:!1,macd:!1,stochastic:!1,heikinAshi:!1,cci:!1,rsi:!1,bb:!1,hma10:!1,hma20:!1,hma55:!1,hma89:!1,hma233:!1,ema10:!1,ema20:!1,ema55:!1,ema89:!1,ema100:!1,ema200:!1,ema233:!1,sma10:!1,sma20:!1,sma55:!1,sma89:!1,sma100:!1,sma200:!1,sma233:!1,psar:!1,kernelChannel:!1,srDinamic:!1},data:[],futures:!0,menuOpen:!1}),v=p(()=>m),S=p(()=>t.indicators),k=p(()=>t.symbols),I=p(()=>t.temporality),F=p(()=>t.exchange),T=p(()=>t.data),D=p(()=>t.menuOpen);function j(c){t.symbols=new String(c).trim()}function x(){this.chart.futures=!this.chart.futures}async function E({symbol:c,temporality:f,cci:n}){const i=`${G}/api/v3/klines?symbol=${c}&interval=${f}`,r=await fetch(i).then(async a=>(await a.json()).flatMap(s=>({time:s[0],open:parseFloat(s[1]),high:parseFloat(s[2]),low:parseFloat(s[3]),close:parseFloat(s[4]),volume:parseFloat(s[5]),timeEnd:s[6],trades:s[7]}))).then(async a=>{if(a.length<n)return a;const b=a.flatMap(h=>h.close);let s=[],u=C.calcularCCI(a,n);return await C.calculoRSI(b).then(async h=>{var g,y;let l=u.length-1;for(var e=a.length-1;e>=0;e--){if(u[l]&&((g=a[e])!=null&&g.time)){if(a[e].cci=u[l],a[e].cci>100){const o="#00f5d4";a[e].color=o,a[e].borderColor=o,a[e].wickColor=o}if(a[e].cci<-100){const o="#ff006e";a[e].color=o,a[e].borderColor=o,a[e].wickColor=o}}if(h[l]&&((y=a[e])!=null&&y.time))a[e].rsi=h[l],s.push(a[e]);else break;l--}return await s.sort((o,w)=>o.time-w.time),s}),s});let d=r.length>0?r:[];return r.length===0&&(d=await fetch(i).then(async a=>(await a.json()).flatMap(s=>({time:s[0],open:parseFloat(s[1]),high:parseFloat(s[2]),low:parseFloat(s[3]),close:parseFloat(s[4]),volume:parseFloat(s[5]),timeEnd:s[6],trades:s[7]}))).then(async a=>{const b=a.flatMap(h=>h.close);let s=[],u=C.calcularCCI(a,n);return await C.calculoRSI(b).then(async h=>{var g,y;let l=u.length-1;for(var e=a.length-1;e>=0;e--){if(u[l]&&((g=a[e])!=null&&g.time)){if(a[e].cci=u[l],a[e].cci>100){const o="#00f5d4";a[e].color=o,a[e].borderColor=o,a[e].wickColor=o}if(a[e].cci<-100){const o="#ff006e";a[e].color=o,a[e].borderColor=o,a[e].wickColor=o}}if(h[l]&&((y=a[e])!=null&&y.time))a[e].rsi=h[l],s.push(a[e]);else break;l--}return await s.sort((o,w)=>o.time-w.time),s}),s})),d}async function M(){const f=await fetch("https://api.binance.com/api/v3/exchangeInfo").then(n=>n!=null&&n.json?n.json():{symbols:[]});return this.chart.pairs=f.symbols,t.pairs}async function A(){const c=t.futures?"https://fapi.binance.com/fapi/v1/exchangeInfo":"https://api.binance.com/api/v1/exchangeInfo",f=new Headers;f.append("Access-Control-Allow-Origin","*");const n={method:"GET",headers:f};try{const i=await fetch(c,n).then(r=>r!=null&&r.json?r.json():{symbols:[]});return this.chart.pairs=i.symbols.filter(r=>r.status==="TRADING"&&r.symbol.includes("USDT")),console.log({url:c,pairs:this.chart.pairs},this.chart.futures),t.pairs}catch(i){return console.log({e:i,url:c}),[]}}async function B(c="BTCUSDT"){const f=new Headers;f.append("Content-Type","application/json");const n={method:"GET",headers:f};return await fetch(`https://fapi.binance.com/fapi/v1/depth?symbol=${c}`,n).then(i=>i.json()).catch(i=>console.log("error",i))}return{customOption:m,getcustomOption:v,isOpenMenu:D,chart:t,getIndicators:S,getData:T,getSymbol:k,getTemporality:I,getExchange:F,setSymbol:j,searchSymbols:A,searchSymbolsSpot:M,searchDataOrderBook:B,searchClandlesSpot:E,toogleCustomOptions:()=>{m.value=!m.value,m.value==!0?(t.indicators.bb=!0,t.indicators.hma10=!0,t.indicators.hma20=!0,t.indicators.divergences=!0,t.indicators.kernelChannel=!0,t.indicators.srDinamic=!0,t.indicators.macd=!0):(t.indicators.bb=!1,t.indicators.hma10=!1,t.indicators.hma20=!1,t.indicators.divergences=!1,t.indicators.kernelChannel=!1,t.indicators.srDinamic=!1,t.indicators.macd=!1)},toogleFutures:x}});export{q as u};
